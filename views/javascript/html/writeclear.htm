<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>在浏览器中显示信息</TITLE>
<!--CSS_START-->
<style>@import url(../html-vss/msdnie4a.css);</style>
<link disabled rel="stylesheet" href="../html-vss/msdn_ie3.css">
<!--CSS_END-->
</HEAD>
<BODY>

<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="_chm_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="alert">
</OBJECT>
</DIV>


<!--Start Head-->
<TABLE class="banner" width="100%" CELLSPACING=0>
<TR>
<TD class="bannerleft" nowrap>JScript&nbsp;</TD>
<TD class="bannerright" nowrap><a href="../html-vss/jsTOC.htm">语言参考</a></TD>
</TR>
</TABLE>
<HR>
<!--End Head-->

<H1><A NAME="writeclear"></A>在浏览器中显示信息</H1>

<P>Microsoft JScript 提供了两种方式来在浏览器中直接显示数据。可以使用<B>write(&nbsp;)</B> 和 <B>writeln(&nbsp;)</B>，这两个函数是<B>document</B> 对象的方法。也可以在浏览器中以表格的方式显示信息，以及用 <A HREF="JavaScript:hhobj_1.Click()">警告、提示和确认</A> 消息框来显示信息。 </P>

<H2>使用document.write(&nbsp;) 和 document.writeln(&nbsp;)</H2>

<P>显示信息最常用的方式是 document 对象的 <B>write(&nbsp;)</B> 方法。该方法用一个字符串作为其参数，并在浏览器中显示。该字符串可以是普通文本或 HTML。</P>

<P>字符串可以用单引号或双引号引起来。这样可以引用那些包含引号或撇号的内容。 </P>

<PRE><CODE>document.write("Pi is approximately equal to " + Math.PI);
document.write(&nbsp;);</CODE></PRE>

<P class=indent><B><B>注意&nbsp;&nbsp;&nbsp;</B></B>下面的简单函数可以避免在浏览器中显示信息时不得不键入 "document.write"。该函数不能告知要显示的信息是否未定义，而是发布给命令 "w();"，该命令将显示一个空行。 </P>

<PRE><CODE>function w(m) { // </CODE>编写函数。
<CODE>m = "" + m + ""; //  </CODE>确保变量<CODE> m </CODE>是一个字符串。
<CODE>if ("undefined" != m) { // </CODE>判别是否为空或其它未定义的项。
&nbsp;&nbsp;&nbsp;<CODE>document.write(m);</CODE>
<CODE>&nbsp;&nbsp;&nbsp;}</CODE>
<CODE>document.write("&lt;br&gt;");</CODE>
<CODE>}</CODE>

<CODE>w('&lt;IMG SRC="horse.gif"&gt;');</CODE>
<CODE>w();</CODE>
<CODE>w("This is an engraving of a horse.");</CODE>
<CODE>w();</CODE></PRE>

<P><B>writeln(&nbsp;) </B>方法与 <B>write(&nbsp;)</B> 方法几乎一样，差别仅在于是前者将在所提供的任何字符串后添加一个换行符。在 HTML 中，这通常只会在后面产生一个空格；不过如果使用了 &lt;PRE&gt; 和 &lt;XMP&gt; 标识，这个换行符会被解释，且在浏览器中显示。</P>

<P>在调用 <B>write(&nbsp;)</B> 方法时，如果该文档不处于在调用 <B>write(&nbsp;)</B> 方法时的打开和分析的过程中，该方法将打开并清除该文档，所以它可能是有危险的。该示例显示了一个每隔一分钟就显示时间的脚本，但是在第一次显示后由于它从过程中将自己清除，因此会导致失败。 </P>

<PRE><CODE>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;SCRIPT LANGUAGE="JScript"&gt;
function singOut()  {
var theMoment = new Date();
var theHour = theMoment.getHours();
var theMinute = theMoment.getMinutes();
var theDisplacement = (theMoment.getTimezoneOffset() / 60);
theHour -= theDisplacement;
if (theHour &gt; 23)  {
theHour -= 24
}
document.write(theHour + " hours, " + theMinute + " minutes, Coordinated Universal Time.");
window.setTimeout("singOut();", 60000);
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;SCRIPT&gt;
singOut();
&lt;/SCRIPT&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</CODE></PRE>

<P>如果使用 window 对象的 <B>alert()</B> 方法而不是 <B>document.write()</B>，则该脚本可以运行。 </P>

<PRE><CODE>window.alert(theHour + " hours, " + theMinute + " minutes, Coordinated Universal Time.");
window.setTimeout("singOut();", 60000);
</CODE>}</PRE>

<H2>清除当前文档</H2>

<P><B>document</B> 对象的 <B>clear()</B> 方法将清空当前文档。该方法也将清除您的脚本（随文档的其他部分一起），因此要特别注意该方法的使用方式及在什么时候使用该方法。 </P>

<PRE><CODE>document.clear();</CODE></PRE>
<!--Copyright_START-->
<DIV CLASS="footer">
<HR><a href="jscopy.htm">&copy; 2000 Microsoft Corporation 版权所有。保留所有权利。使用规定。</a><br>
</DIV> <!--Copyright_END-->

</BODY>
</HTML>
